import{r as h,j as e,L as te,S as U}from"./app-CGBEw2mQ.js";import{A as ae}from"./app-layout-CS8QzYW-.js";import{F as p,I as v,S as T,s as A}from"./DeleteOutlined-BqA0TRgL.js";import{T as Y}from"./index-B9LGkFbD.js";import{_ as se,u as Z,a as le,c as ee,b as G,d as re,K as Q,g as ce,m as de,r as oe,e as N,f as ue,F as he,C as me,D as ge,h as xe,W as pe,R as Se,B as y}from"./AntdIcon-j_M35Icp.js";import{R as H,F,M as J,a as V,b as R}from"./PlusOutlined-Cz50r-Ob.js";import{S as W}from"./EditOutlined-DmEOkBk_.js";import"./app-logo-icon-BuLI_f4t.js";import"./index-DFq1oOcb.js";import"./index-B1iFgkKO.js";import"./index-CohjghJM.js";var Ce=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],ne=h.forwardRef(function(n,i){var c,l=n.prefixCls,d=l===void 0?"rc-switch":l,m=n.className,S=n.checked,r=n.defaultChecked,s=n.disabled,o=n.loadingIcon,C=n.checkedChildren,g=n.unCheckedChildren,_=n.onClick,x=n.onChange,L=n.onKeyDown,w=se(n,Ce),P=Z(!1,{value:S,defaultValue:r}),$=le(P,2),j=$[0],f=$[1];function k(I,O){var M=j;return s||(M=I,f(M),x==null||x(M,O)),M}function q(I){I.which===Q.LEFT?k(!1,I):I.which===Q.RIGHT&&k(!0,I),L==null||L(I)}function b(I){var O=k(!j,I);_==null||_(O,I)}var D=ee(d,m,(c={},G(c,"".concat(d,"-checked"),j),G(c,"".concat(d,"-disabled"),s),c));return h.createElement("button",re({},w,{type:"button",role:"switch","aria-checked":j,disabled:s,className:D,ref:i,onKeyDown:q,onClick:b}),o,h.createElement("span",{className:"".concat(d,"-inner")},h.createElement("span",{className:"".concat(d,"-inner-checked")},C),h.createElement("span",{className:"".concat(d,"-inner-unchecked")},g)))});ne.displayName="Switch";const be=n=>{const{componentCls:i,trackHeightSM:c,trackPadding:l,trackMinWidthSM:d,innerMinMarginSM:m,innerMaxMarginSM:S,handleSizeSM:r,calc:s}=n,o=`${i}-inner`,C=N(s(r).add(s(l).mul(2)).equal()),g=N(s(S).mul(2).equal());return{[i]:{[`&${i}-small`]:{minWidth:d,height:c,lineHeight:N(c),[`${i}-inner`]:{paddingInlineStart:S,paddingInlineEnd:m,[`${o}-checked, ${o}-unchecked`]:{minHeight:c},[`${o}-checked`]:{marginInlineStart:`calc(-100% + ${C} - ${g})`,marginInlineEnd:`calc(100% - ${C} + ${g})`},[`${o}-unchecked`]:{marginTop:s(c).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${i}-handle`]:{width:r,height:r},[`${i}-loading-icon`]:{top:s(s(r).sub(n.switchLoadingIconSize)).div(2).equal(),fontSize:n.switchLoadingIconSize},[`&${i}-checked`]:{[`${i}-inner`]:{paddingInlineStart:m,paddingInlineEnd:S,[`${o}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${o}-unchecked`]:{marginInlineStart:`calc(100% - ${C} + ${g})`,marginInlineEnd:`calc(-100% + ${C} - ${g})`}},[`${i}-handle`]:{insetInlineStart:`calc(100% - ${N(s(r).add(l).equal())})`}},[`&:not(${i}-disabled):active`]:{[`&:not(${i}-checked) ${o}`]:{[`${o}-unchecked`]:{marginInlineStart:s(n.marginXXS).div(2).equal(),marginInlineEnd:s(n.marginXXS).mul(-1).div(2).equal()}},[`&${i}-checked ${o}`]:{[`${o}-checked`]:{marginInlineStart:s(n.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:s(n.marginXXS).div(2).equal()}}}}}}},ve=n=>{const{componentCls:i,handleSize:c,calc:l}=n;return{[i]:{[`${i}-loading-icon${n.iconCls}`]:{position:"relative",top:l(l(c).sub(n.fontSize)).div(2).equal(),color:n.switchLoadingIconColor,verticalAlign:"top"},[`&${i}-checked ${i}-loading-icon`]:{color:n.switchColor}}}},Ie=n=>{const{componentCls:i,trackPadding:c,handleBg:l,handleShadow:d,handleSize:m,calc:S}=n,r=`${i}-handle`;return{[i]:{[r]:{position:"absolute",top:c,insetInlineStart:c,width:m,height:m,transition:`all ${n.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:l,borderRadius:S(m).div(2).equal(),boxShadow:d,transition:`all ${n.switchDuration} ease-in-out`,content:'""'}},[`&${i}-checked ${r}`]:{insetInlineStart:`calc(100% - ${N(S(m).add(c).equal())})`},[`&:not(${i}-disabled):active`]:{[`${r}::before`]:{insetInlineEnd:n.switchHandleActiveInset,insetInlineStart:0},[`&${i}-checked ${r}::before`]:{insetInlineEnd:0,insetInlineStart:n.switchHandleActiveInset}}}}},fe=n=>{const{componentCls:i,trackHeight:c,trackPadding:l,innerMinMargin:d,innerMaxMargin:m,handleSize:S,calc:r}=n,s=`${i}-inner`,o=N(r(S).add(r(l).mul(2)).equal()),C=N(r(m).mul(2).equal());return{[i]:{[s]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:m,paddingInlineEnd:d,transition:`padding-inline-start ${n.switchDuration} ease-in-out, padding-inline-end ${n.switchDuration} ease-in-out`,[`${s}-checked, ${s}-unchecked`]:{display:"block",color:n.colorTextLightSolid,fontSize:n.fontSizeSM,transition:`margin-inline-start ${n.switchDuration} ease-in-out, margin-inline-end ${n.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:c},[`${s}-checked`]:{marginInlineStart:`calc(-100% + ${o} - ${C})`,marginInlineEnd:`calc(100% - ${o} + ${C})`},[`${s}-unchecked`]:{marginTop:r(c).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${i}-checked ${s}`]:{paddingInlineStart:d,paddingInlineEnd:m,[`${s}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${s}-unchecked`]:{marginInlineStart:`calc(100% - ${o} + ${C})`,marginInlineEnd:`calc(-100% + ${o} - ${C})`}},[`&:not(${i}-disabled):active`]:{[`&:not(${i}-checked) ${s}`]:{[`${s}-unchecked`]:{marginInlineStart:r(l).mul(2).equal(),marginInlineEnd:r(l).mul(-1).mul(2).equal()}},[`&${i}-checked ${s}`]:{[`${s}-checked`]:{marginInlineStart:r(l).mul(-1).mul(2).equal(),marginInlineEnd:r(l).mul(2).equal()}}}}}},we=n=>{const{componentCls:i,trackHeight:c,trackMinWidth:l}=n;return{[i]:Object.assign(Object.assign(Object.assign(Object.assign({},oe(n)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:l,height:c,lineHeight:N(c),verticalAlign:"middle",background:n.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${n.motionDurationMid}`,userSelect:"none",[`&:hover:not(${i}-disabled)`]:{background:n.colorTextTertiary}}),ue(n)),{[`&${i}-checked`]:{background:n.switchColor,[`&:hover:not(${i}-disabled)`]:{background:n.colorPrimaryHover}},[`&${i}-loading, &${i}-disabled`]:{cursor:"not-allowed",opacity:n.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${i}-rtl`]:{direction:"rtl"}})}},$e=n=>{const{fontSize:i,lineHeight:c,controlHeight:l,colorWhite:d}=n,m=i*c,S=l/2,r=2,s=m-r*2,o=S-r*2;return{trackHeight:m,trackHeightSM:S,trackMinWidth:s*2+r*4,trackMinWidthSM:o*2+r*2,trackPadding:r,handleBg:d,handleSize:s,handleSizeSM:o,handleShadow:`0 2px 4px 0 ${new he("#00230b").setA(.2).toRgbString()}`,innerMinMargin:s/2,innerMaxMargin:s+r+r*2,innerMinMarginSM:o/2,innerMaxMarginSM:o+r+r*2}},je=ce("Switch",n=>{const i=de(n,{switchDuration:n.motionDurationMid,switchColor:n.colorPrimary,switchDisabledOpacity:n.opacityLoading,switchLoadingIconSize:n.calc(n.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${n.opacityLoading})`,switchHandleActiveInset:"-30%"});return[we(i),fe(i),Ie(i),ve(i),be(i)]},$e);var ye=function(n,i){var c={};for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&i.indexOf(l)<0&&(c[l]=n[l]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,l=Object.getOwnPropertySymbols(n);d<l.length;d++)i.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(n,l[d])&&(c[l[d]]=n[l[d]]);return c};const ke=h.forwardRef((n,i)=>{const{prefixCls:c,size:l,disabled:d,loading:m,className:S,rootClassName:r,style:s,checked:o,value:C,defaultChecked:g,defaultValue:_,onChange:x}=n,L=ye(n,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[w,P]=Z(!1,{value:o??C,defaultValue:g??_}),{getPrefixCls:$,direction:j,switch:f}=h.useContext(me),k=h.useContext(ge),q=(d??k)||m,b=$("switch",c),D=h.createElement("div",{className:`${b}-handle`},m&&h.createElement(Se,{className:`${b}-loading-icon`})),[I,O,M]=je(b),z=xe(l),a=ee(f==null?void 0:f.className,{[`${b}-small`]:z==="small",[`${b}-loading`]:m,[`${b}-rtl`]:j==="rtl"},S,r,O,M),t=Object.assign(Object.assign({},f==null?void 0:f.style),s),u=(...E)=>{P(E[0]),x==null||x.apply(void 0,E)};return I(h.createElement(pe,{component:"Switch"},h.createElement(ne,Object.assign({},L,{checked:w,onChange:u,prefixCls:b,className:a,style:t,disabled:q,ref:i,loadingIcon:D}))))}),ie=ke;ie.__ANT_SWITCH=!0;const Me=[{title:"Dashboard",href:"/dashboard"},{title:"Barangays",href:"/barangays"},{title:"Info",href:"/barangay-info"}],{TabPane:K}=Y,{Search:B}=v;function He({barangay:n}){const[i,c]=h.useState("1"),[l,d]=h.useState(""),[m,S]=h.useState(""),[r,s]=h.useState(""),[o,C]=h.useState(!1),[g,_]=h.useState("user"),[x,L]=h.useState(null),[w]=p.useForm(),[P,$]=h.useState(n.users||[]),[j,f]=h.useState(n.drivers||[]),[k,q]=h.useState(n.vehicles||[]);h.useEffect(()=>{$(n.users||[]),f(n.drivers||[]),q(n.vehicles||[])},[n]);const b=(a,t)=>{if(_(a),L(t),t){const u={...t};a==="driver"&&t.user&&(u.email=t.user.email,u.user_id=t.user.id),w.setFieldsValue(u)}else w.resetFields();C(!0)},D=(a,t)=>{J.confirm({title:"Are you sure you want to delete this item?",onOk:()=>{U.delete(`/barangay/${n.id}/${a}/${t}`,{preserveScroll:!0,onSuccess:()=>{switch(A.success("Deleted successfully"),a){case"user":$(P.filter(u=>u.id!==t));break;case"driver":f(j.filter(u=>u.id!==t));break;case"vehicle":q(k.filter(u=>u.id!==t));break}},onError:()=>{A.error("Failed to delete")}})}})},I=()=>{w.validateFields().then(a=>{const t=x?`/barangay/${n.id}/${g}/${x.id}`:`/barangay/${n.id}/${g}`;U[x?"put":"post"](t,a,{preserveScroll:!0,onSuccess:u=>{A.success(`${x?"Updated":"Created"} successfully`),C(!1),w.resetFields(),g==="driver"?(f(u.props.drivers||[]),$(u.props.users||[])):g==="user"?$(u.props.users||[]):g==="vehicle"&&q(u.props.vehicles||[])},onError:u=>{A.error(`Operation failed: ${u.message}`)}})})},O=[{title:"Name",dataIndex:"name",key:"name",filteredValue:[l],onFilter:(a,t)=>t.name.toLowerCase().includes(a.toLowerCase())||t.email.toLowerCase().includes(a.toLowerCase())},{title:"Email",dataIndex:"email",key:"email"},{title:"Status",dataIndex:"is_active",key:"is_active",render:a=>e.jsx("span",{className:a?"text-green-500":"text-red-500",children:a?"Active":"Inactive"})},{title:"Actions",key:"actions",render:(a,t)=>e.jsxs(W,{children:[e.jsx(y,{icon:e.jsx(V,{}),onClick:()=>b("user",t)}),e.jsx(y,{icon:e.jsx(R,{}),danger:!0,onClick:()=>D("user",t.id)})]})}],M=[{title:"Name",dataIndex:"name",key:"name",filteredValue:[m],onFilter:(a,t)=>{var u,E,X;return t.name.toLowerCase().includes(a.toLowerCase())||((E=(u=t.user)==null?void 0:u.email)==null?void 0:E.toLowerCase().includes(a.toLowerCase()))||!1||t.drivers_license_number.toLowerCase().includes(a.toLowerCase())||((X=t.contact_number)==null?void 0:X.toLowerCase().includes(a.toLowerCase()))||!1}},{title:"Email",key:"email",render:(a,t)=>{var u;return((u=t.user)==null?void 0:u.email)||"-"}},{title:"License No",dataIndex:"drivers_license_number",key:"drivers_license_number"},{title:"Contact",dataIndex:"contact_number",key:"contact_number",render:a=>a||"-"},{title:"Status",key:"status",render:(a,t)=>{var u,E;return e.jsx("span",{className:(u=t.user)!=null&&u.is_active?"text-green-500":"text-red-500",children:(E=t.user)!=null&&E.is_active?"Active":"Inactive"})}},{title:"Actions",key:"actions",render:(a,t)=>e.jsxs(W,{children:[e.jsx(y,{icon:e.jsx(V,{}),onClick:()=>b("driver",t)}),e.jsx(y,{icon:e.jsx(R,{}),danger:!0,onClick:()=>D("driver",t.id)})]})}],z=[{title:"Plate Number",dataIndex:"plate_number",key:"plate_number",filteredValue:[r],onFilter:(a,t)=>t.plate_number.toLowerCase().includes(a.toLowerCase())||t.vehicle_type.toLowerCase().includes(a.toLowerCase())||t.brand&&t.brand.toLowerCase().includes(a.toLowerCase())||t.model&&t.model.toLowerCase().includes(a.toLowerCase())},{title:"Type",dataIndex:"vehicle_type",key:"vehicle_type"},{title:"Brand",dataIndex:"brand",key:"brand"},{title:"Model",dataIndex:"model",key:"model"},{title:"Actions",key:"actions",render:(a,t)=>e.jsxs(W,{children:[e.jsx(y,{icon:e.jsx(V,{}),onClick:()=>b("vehicle",t)}),e.jsx(y,{icon:e.jsx(R,{}),danger:!0,onClick:()=>D("vehicle",t.id)})]})}];return e.jsxs(ae,{breadcrumbs:Me,children:[e.jsx(te,{title:"Barangay Information"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx("div",{className:"flex justify-between mb-4",children:e.jsxs("h1",{className:"text-2xl font-bold",children:["Barangay ",n.name," Info"]})}),e.jsxs(Y,{activeKey:i,onChange:c,children:[e.jsxs(K,{tab:"User Admins",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx(B,{placeholder:"Search users...",onChange:a=>d(a.target.value),style:{width:300}}),e.jsx(y,{type:"primary",icon:e.jsx(H,{}),onClick:()=>b("user"),children:"Add Admin"})]}),e.jsx(F,{columns:O,dataSource:P,rowKey:"id"})]},"1"),e.jsxs(K,{tab:"Drivers",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx(B,{placeholder:"Search drivers...",onChange:a=>S(a.target.value),style:{width:300}}),e.jsx(y,{type:"primary",icon:e.jsx(H,{}),onClick:()=>b("driver"),children:"Add Driver"})]}),e.jsx(F,{columns:M,dataSource:j,rowKey:"id"})]},"2"),e.jsxs(K,{tab:"Vehicle Monitoring",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx(B,{placeholder:"Search vehicles...",onChange:a=>s(a.target.value),style:{width:300}}),e.jsx(y,{type:"primary",icon:e.jsx(H,{}),onClick:()=>b("vehicle"),children:"Add Vehicle"})]}),e.jsx(F,{columns:z,dataSource:k,rowKey:"id"})]},"3")]}),e.jsx(J,{title:`${x?"Edit":"Add"} ${g.charAt(0).toUpperCase()+g.slice(1)}`,open:o,onOk:I,onCancel:()=>{C(!1),w.resetFields()},width:600,children:e.jsxs(p,{form:w,layout:"vertical",children:[g==="user"&&e.jsxs(e.Fragment,{children:[e.jsx(p.Item,{name:"name",label:"Name",rules:[{required:!0}],children:e.jsx(v,{})}),e.jsx(p.Item,{name:"email",label:"Email",rules:[{required:!0,type:"email"}],children:e.jsx(v,{})}),!x&&e.jsx(p.Item,{name:"password",label:"Password",rules:[{required:!x}],children:e.jsx(v.Password,{})}),e.jsx(p.Item,{name:"is_active",label:"Status",valuePropName:"checked",children:e.jsx(ie,{checkedChildren:"Active",unCheckedChildren:"Inactive",defaultChecked:!0})})]}),g==="driver"&&e.jsxs(e.Fragment,{children:[e.jsx(p.Item,{name:"name",label:"Name",rules:[{required:!0}],children:e.jsx(v,{})}),e.jsx(p.Item,{name:"email",label:"Email",rules:[{required:!0,type:"email"}],children:e.jsx(v,{})}),!x&&e.jsx(p.Item,{name:"password",label:"Password",rules:[{required:!0}],children:e.jsx(v.Password,{})}),e.jsx(p.Item,{name:"drivers_license_number",label:"License No",rules:[{required:!0}],children:e.jsx(v,{})}),e.jsx(p.Item,{name:"contact_number",label:"Contact Number",children:e.jsx(v,{})}),x&&e.jsx(p.Item,{name:"user_id",hidden:!0,children:e.jsx(v,{type:"hidden"})})]}),g==="vehicle"&&e.jsxs(e.Fragment,{children:[x&&e.jsx(p.Item,{name:"vehicle_id",hidden:!0,children:e.jsx(v,{type:"hidden"})}),e.jsx(p.Item,{name:"code",label:"Code",rules:[{required:!0}],children:e.jsx(v,{})}),e.jsx(p.Item,{name:"plate_number",label:"Plate Number",rules:[{required:!0}],children:e.jsx(v,{})}),e.jsx(p.Item,{name:"vehicle_type",label:"Vehicle Type",rules:[{required:!0}],children:e.jsxs(T,{children:[e.jsx(T.Option,{value:"Motorcycle",children:"Motorcycle"}),e.jsx(T.Option,{value:"Car",children:"Car"}),e.jsx(T.Option,{value:"Truck",children:"Truck"}),e.jsx(T.Option,{value:"Van",children:"Van"}),e.jsx(T.Option,{value:"SUV",children:"SUV"})]})}),e.jsx(p.Item,{name:"brand",label:"Brand",children:e.jsx(v,{})}),e.jsx(p.Item,{name:"model",label:"Model",children:e.jsx(v,{})})]})]})})]})]})}export{He as default};
