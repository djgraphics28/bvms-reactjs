import{r as a,a as N,j as e,L as k}from"./app-C_tRCv81.js";import{A as L}from"./app-layout-UhI7It2a.js";import{L as F,G as C,P as S,M}from"./esm-BC7WPFuJ.js";import"./app-logo-icon-enPfDlCA.js";import"./index--2YMDKUm.js";import"./index-B4wqM11G.js";const A=[{title:"Vehicles",href:"/vehicles"},{title:"Real-Time Location",href:"/vehicles/location"}],E="AIzaSyC_WZ0T_FCfAV_G1yfuBGozFa2zOX9l82c";function V({vehicle:r}){const[l,h]=a.useState([]),[p,g]=a.useState({lat:15.9061,lng:120.5853}),[n,u]=a.useState(null),[f,b]=a.useState(!1),[i,c]=a.useState(null),v={width:"100%",height:"100%"},d=a.useCallback(async()=>{try{const o=(await N.get(`/vehicles/${r.id}/get-location`)).data;if(h(o),o.length>0){const x=o[o.length-1],m={lat:parseFloat(x.latitude),lng:parseFloat(x.longitude)};g(m),i&&i.panTo(m)}}catch(t){console.error("Error fetching locations:",t),u("Failed to fetch location data")}},[r.id,i]);a.useEffect(()=>{d();const t=setInterval(d,5e3);return()=>clearInterval(t)},[d]);const j=l.map(t=>({lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)})),s=l.length>0?l[l.length-1]:null,y=a.useCallback(t=>{c(t)},[]),w=a.useCallback(()=>{c(null)},[]);return e.jsxs(L,{breadcrumbs:A,children:[e.jsx(k,{title:"Real-Time Location"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"grid auto-rows-min gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"w-full h-32 mb-4"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Vehicle Description"}),e.jsxs("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:[r.plate_number," • ",r.brand," ",r.model," • ",r.color]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"Active"})]})]})}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Current Location"}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s?`${parseFloat(s.latitude).toFixed(6)}, ${parseFloat(s.longitude).toFixed(6)}`:"No Data"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s?new Date(s.created_at).toLocaleString():"--:--"})]})}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trip Statistics"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:l.length}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Waypoints"})]}),e.jsx("div",{className:"text-sm text-blue-500",children:"View Details →"})]})})]}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min",children:n?e.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:n}):e.jsx(F,{googleMapsApiKey:E,onLoad:()=>b(!0),children:f?e.jsxs(C,{mapContainerStyle:v,center:p,zoom:18,options:{streetViewControl:!0,mapTypeControl:!1,fullscreenControl:!1},onLoad:y,onUnmount:w,children:[e.jsx(S,{path:j,options:{strokeColor:"#0000FF",strokeOpacity:1,strokeWeight:4,clickable:!1,draggable:!1,editable:!1,visible:!0,zIndex:1}}),s&&e.jsx(M,{position:{lat:parseFloat(s.latitude),lng:parseFloat(s.longitude)},icon:{url:"https://maps.google.com/mapfiles/kml/shapes/cabs.png",scaledSize:new window.google.maps.Size(32,32)},animation:window.google.maps.Animation.BOUNCE})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-pulse text-gray-500",children:"Loading map..."})})})})]})]})}export{V as default};
