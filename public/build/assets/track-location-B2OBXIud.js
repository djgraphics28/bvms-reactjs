import{r as t,j as e,L as N}from"./app-XayEYSYD.js";import{L as W,G as O,M as v,D as _,T as $}from"./esm-n2EXybXz.js";import{A as V}from"./app-layout-BLklepEH.js";import"./index-CMHfjOm0.js";import"./app-logo-icon-wuWTRmV1.js";import"./index-DPAlOoSd.js";import"./index-BMuuFPYu.js";const K=[{title:"Dashboard",href:"/dashboard"},{title:"Incidents",href:"/incident-reports"},{title:"Track Location",href:"/track-location"}],F="AIzaSyC_WZ0T_FCfAV_G1yfuBGozFa2zOX9l82c",B={width:"100%",height:"100vh"},ee=({incident:p})=>{const[P,w]=t.useState(null),[x,T]=t.useState(null),[y,C]=t.useState(""),[j,k]=t.useState(""),[o,S]=t.useState(null),[r,M]=t.useState(google.maps.TravelMode.DRIVING),[d,I]=t.useState(!1),[n,R]=t.useState(null),[U,A]=t.useState(""),[u,L]=t.useState(""),i={lat:parseFloat(p.latitude),lng:parseFloat(p.longitude)};t.useEffect(()=>{const s=navigator.geolocation.watchPosition(a=>{const l={lat:a.coords.latitude,lng:a.coords.longitude};w(l),S(l),n&&n.panTo(l)},a=>{console.error("Error tracking location:",a)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0});return()=>{navigator.geolocation.clearWatch(s)}},[n]),t.useEffect(()=>{o&&window.google&&new google.maps.DirectionsService().route({origin:o,destination:i,travelMode:r,provideRouteAlternatives:!1,drivingOptions:{departureTime:new Date,trafficModel:google.maps.TrafficModel.BEST_GUESS}},(a,l)=>{var h,m,f;if(l===google.maps.DirectionsStatus.OK&&a){T(a);const c=a.routes[0].legs[0];if(C(((h=c.distance)==null?void 0:h.text)||""),k(((m=c.duration)==null?void 0:m.text)||""),(f=c.duration)!=null&&f.value){const E=new Date,b=new Date(E.getTime()+c.duration.value*1e3);A(b.toLocaleTimeString()),L(`ETA: ${b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`)}}else console.error("Directions request failed:",l)})},[o,i,r]);const D=s=>{R(s)},g=s=>{M(s)},G=()=>{I(!d)},z=()=>{n&&o&&(n.panTo(o),n.setZoom(15))};return e.jsxs(V,{breadcrumbs:K,children:[e.jsx(N,{title:"Incidents Management"}),e.jsx(W,{googleMapsApiKey:F,libraries:["places","geometry"],children:e.jsxs("div",{style:{position:"relative",height:"100vh"},children:[e.jsxs(O,{mapContainerStyle:B,center:o||i,zoom:15,onLoad:D,options:{zoomControl:!0,mapTypeControl:!0,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!0},children:[o&&e.jsx(v,{position:o,label:"You",icon:{url:"https://maps.google.com/mapfiles/ms/icons/blue-dot.png"}}),e.jsx(v,{position:i,label:"Incident",icon:{url:"https://maps.google.com/mapfiles/ms/icons/red-dot.png"}}),x&&e.jsx(_,{directions:x,options:{suppressMarkers:!0,preserveViewport:!0,polylineOptions:{strokeColor:"#1a73e8",strokeOpacity:.8,strokeWeight:6,zIndex:1}}}),d&&e.jsx($,{})]}),e.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",padding:"10px",zIndex:1,display:"flex",flexDirection:"column",gap:"10px"},children:[e.jsx("button",{onClick:()=>g(google.maps.TravelMode.DRIVING),style:{backgroundColor:r===google.maps.TravelMode.DRIVING?"#e8f0fe":"white",color:r===google.maps.TravelMode.DRIVING?"#1a73e8":"black",border:"1px solid #dadce0",borderRadius:"4px",padding:"8px 12px",cursor:"pointer"},children:"🚗 Drive"}),e.jsx("button",{onClick:()=>g(google.maps.TravelMode.WALKING),style:{backgroundColor:r===google.maps.TravelMode.WALKING?"#e8f0fe":"white",color:r===google.maps.TravelMode.WALKING?"#1a73e8":"black",border:"1px solid #dadce0",borderRadius:"4px",padding:"8px 12px",cursor:"pointer"},children:"🚶 Walk"}),e.jsx("button",{onClick:()=>g(google.maps.TravelMode.TRANSIT),style:{backgroundColor:r===google.maps.TravelMode.TRANSIT?"#e8f0fe":"white",color:r===google.maps.TravelMode.TRANSIT?"#1a73e8":"black",border:"1px solid #dadce0",borderRadius:"4px",padding:"8px 12px",cursor:"pointer"},children:"🚆 Transit"}),e.jsx("button",{onClick:G,style:{backgroundColor:d?"#e8f0fe":"white",color:d?"#1a73e8":"black",border:"1px solid #dadce0",borderRadius:"4px",padding:"8px 12px",cursor:"pointer"},children:"🚦 Traffic"}),e.jsx("button",{onClick:z,style:{backgroundColor:"white",border:"1px solid #dadce0",borderRadius:"4px",padding:"8px 12px",cursor:"pointer"},children:"🎯 Center"})]}),e.jsxs("div",{style:{position:"absolute",bottom:"20px",left:"20px",right:"20px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",padding:"16px",zIndex:1,maxWidth:"400px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"18px",color:"#1a73e8"},children:"Route to Incident"}),e.jsx("p",{style:{margin:"4px 0",fontSize:"14px",color:"#5f6368"},children:p.title})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{style:{margin:0,fontSize:"16px",fontWeight:"bold"},children:y}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:"14px"},children:j})]})]}),u&&e.jsxs("div",{style:{backgroundColor:"#f1f3f4",borderRadius:"4px",padding:"8px",marginTop:"8px",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{backgroundColor:"#1a73e8",color:"white",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"8px"},children:"⏱"}),e.jsx("span",{children:u})]}),e.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>window.open(`https://www.google.com/maps/dir/?api=1&origin=${o==null?void 0:o.lat},${o==null?void 0:o.lng}&destination=${i.lat},${i.lng}&travelmode=${r.toLowerCase()}`,"_blank"),style:{backgroundColor:"#1a73e8",color:"white",border:"none",borderRadius:"4px",padding:"8px 16px",cursor:"pointer",flex:1},children:"Open in Google Maps"}),e.jsx("button",{onClick:()=>window.open(`https://www.waze.com/ul?ll=${i.lat}%2C${i.lng}&navigate=yes`,"_blank"),style:{backgroundColor:"#33ccff",color:"white",border:"none",borderRadius:"4px",padding:"8px 16px",cursor:"pointer",flex:1},children:"Open in Waze"})]})]})]})})]})};export{ee as default};
