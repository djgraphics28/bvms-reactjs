import{r as t,a as y,j as e,L as N}from"./app-C00gqaXt.js";import{A as k}from"./app-layout-DjaNfa2R.js";import{L,G as C,M as S}from"./esm-DPaY8_WS.js";import"./app-logo-icon-Bt1CmNXB.js";import"./index-CnzNiQl8.js";import"./index-DOV4yghA.js";const F=[{title:"Vehicles",href:"/vehicles"},{title:"Real-Time Location",href:"/vehicles/location"}],M="AIzaSyC_WZ0T_FCfAV_G1yfuBGozFa2zOX9l82c";function I({vehicle:a}){const[l,h]=t.useState([]),[g,p]=t.useState({lat:15.9061,lng:120.5853}),[n,u]=t.useState(null),[f,b]=t.useState(!1),[i,c]=t.useState(null),j={width:"100%",height:"100%"},d=t.useCallback(async()=>{try{const o=(await y.get(`/vehicles/${a.id}/get-location`)).data;if(h(o),o.length>0){const x=o[o.length-1],m={lat:parseFloat(x.latitude),lng:parseFloat(x.longitude)};p(m),i&&i.panTo(m)}}catch(r){console.error("Error fetching locations:",r),u("Failed to fetch location data")}},[a.id,i]);t.useEffect(()=>{d();const r=setInterval(d,2e3);return()=>clearInterval(r)},[d]);const s=l.length>0?l[l.length-1]:null,v=t.useCallback(r=>{c(r)},[]),w=t.useCallback(()=>{c(null)},[]);return e.jsxs(k,{breadcrumbs:F,children:[e.jsx(N,{title:"Real-Time Location"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"grid auto-rows-min gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"w-full h-32 mb-4",children:e.jsx("img",{src:"/placeholder-vehicle.png",alt:`${a.brand} ${a.model}`,className:"w-full h-full object-cover rounded-lg"})}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Vehicle Description"}),e.jsxs("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:[a.plate_number," • ",a.brand," ",a.model," • ",a.color]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"Active"})]})]})}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Current Location"}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s?`${parseFloat(s.latitude).toFixed(6)}, ${parseFloat(s.longitude).toFixed(6)}`:"No Data"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s?new Date(s.created_at).toLocaleString():"--:--"})]})}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trip Statistics"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:l.length}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Waypoints"})]}),e.jsx("div",{className:"text-sm text-blue-500",children:"View Details →"})]})})]}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min",children:n?e.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:n}):e.jsx(L,{googleMapsApiKey:M,onLoad:()=>b(!0),children:f?e.jsx(C,{mapContainerStyle:j,center:g,zoom:18,options:{streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1},onLoad:v,onUnmount:w,children:s&&e.jsx(S,{position:{lat:parseFloat(s.latitude),lng:parseFloat(s.longitude)},icon:{url:"https://maps.google.com/mapfiles/kml/shapes/cabs.png",scaledSize:new window.google.maps.Size(32,32)},animation:window.google.maps.Animation.BOUNCE})}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-pulse text-gray-500",children:"Loading map..."})})})})]})]})}export{I as default};
