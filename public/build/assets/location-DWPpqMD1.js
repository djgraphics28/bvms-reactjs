import{r as t,a as w,j as e,L as N}from"./app-BDc6yEHN.js";import{A as k}from"./app-layout-CYL7HjgH.js";import{L,G as C,M as S}from"./esm-DrZTZMUQ.js";import"./app-logo-icon-CYRhBay7.js";import"./index-DHXwK3o4.js";import"./index-8bn2Y2ye.js";const F=[{title:"Vehicles",href:"/vehicles"},{title:"Real-Time Location",href:"/vehicles/location"}],M="AIzaSyC_WZ0T_FCfAV_G1yfuBGozFa2zOX9l82c";function I({vehicle:s}){const[l,h]=t.useState([]),[p,g]=t.useState({lat:15.9061,lng:120.5853}),[n,f]=t.useState(null),[u,b]=t.useState(!1),[i,c]=t.useState(null),v={width:"100%",height:"100%"},d=t.useCallback(async()=>{try{const o=(await w.get(`/vehicles/${s.id}/get-location`)).data;if(h(o),o.length>0){const x=o[o.length-1],m={lat:parseFloat(x.latitude),lng:parseFloat(x.longitude)};g(m),i&&i.panTo(m)}}catch(r){console.error("Error fetching locations:",r),f("Failed to fetch location data")}},[s.id,i]);t.useEffect(()=>{d();const r=setInterval(d,2e3);return()=>clearInterval(r)},[d]);const a=l.length>0?l[l.length-1]:null,j=t.useCallback(r=>{c(r)},[]),y=t.useCallback(()=>{c(null)},[]);return e.jsxs(k,{breadcrumbs:F,children:[e.jsx(N,{title:"Real-Time Location"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"grid auto-rows-min gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"w-full h-32 mb-4"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Vehicle Description"}),e.jsxs("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:[s.plate_number," • ",s.brand," ",s.model," • ",s.color]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"Active"})]})]})}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Current Location"}),e.jsx("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:a?`${parseFloat(a.latitude).toFixed(6)}, ${parseFloat(a.longitude).toFixed(6)}`:"No Data"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a?new Date(a.created_at).toLocaleString():"--:--"})]})}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative aspect-video overflow-hidden rounded-xl border bg-white dark:bg-gray-800 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trip Statistics"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:l.length}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Waypoints"})]}),e.jsx("div",{className:"text-sm text-blue-500",children:"View Details →"})]})})]}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min",children:n?e.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:n}):e.jsx(L,{googleMapsApiKey:M,onLoad:()=>b(!0),children:u?e.jsx(C,{mapContainerStyle:v,center:p,zoom:18,options:{streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1},onLoad:j,onUnmount:y,children:a&&e.jsx(S,{position:{lat:parseFloat(a.latitude),lng:parseFloat(a.longitude)},icon:{url:"https://maps.google.com/mapfiles/kml/shapes/cabs.png",scaledSize:new window.google.maps.Size(32,32)},animation:window.google.maps.Animation.BOUNCE})}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-pulse text-gray-500",children:"Loading map..."})})})})]})]})}export{I as default};
